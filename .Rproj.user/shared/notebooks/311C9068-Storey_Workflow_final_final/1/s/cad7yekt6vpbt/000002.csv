"0","#library(mice) #Use mice library to check for missing variable patterns in variables related to surveys"
"0","#md.pattern(select(Fenton, teacher1, selfefficacy_post, selfefficacy_pre, teacher2, teacher3, teacher4, centered_gender, Weight))"
"0",""
"0","#Put needed variables in new dataframe for survey analysis, filter for complete cases"
"0","surveyFenton <- select(Fenton, treatment, selfefficacy_post, selfefficacy_pre, selfefficacy_pre.c, Weight, enjoyment_pre, enjoyment_pre.c, enjoyment_post, effort_pre, effort_pre.c, effort_post, answersense_pre, answersense_pre.c, answersense_post) %>% "
"0","                       filter(complete.cases(.))"
"0",""
"0","#Run linear models "
"0","ma <- lm(selfefficacy_post ~ treatment+selfefficacy_pre.c, weights=Weight, data=surveyFenton)"
"0","mb <- lm(enjoyment_post ~ treatment+enjoyment_pre.c, weights=Weight, data=surveyFenton)"
"0","mc <- lm(effort_post ~ treatment+effort_pre.c, weights=Weight, data=surveyFenton)"
"0","md <- lm(answersense_post ~ treatment+answersense_pre.c, weights=Weight, data=surveyFenton)"
"0",""
"0","#Use linear models to predict regression adjusted values"
"0","surveyFenton$selfefficacy_post_fit <- predict(ma)"
"0","surveyFenton$enjoyment_post_fit <- predict(mb)"
"0","surveyFenton$effort_post_fit <- predict(mc)"
"0","surveyFenton$answersense_post_fit <- predict(md)"
"0",""
"0","#Calculate regression-adjusted means from individual values"
"0","surveyFenton <- surveyFenton %>% "
"0","  group_by(treatment) %>% #summarize regression-adjusted mean values"
"0","  summarize("
"0","    `Math Self-Efficacy` = mean(selfefficacy_post_fit, na.rm=TRUE),"
"0","    `Math Enjoyment` = mean(enjoyment_post_fit, na.rm=TRUE),"
"0","    `Math Effort` = mean(effort_post_fit, na.rm=TRUE),"
"0","    `Math Answers Make Sense` = mean(answersense_post_fit, na.rm=TRUE),"
"0","  ) %>% "
"0","  pivot_longer( #pivot means to longer format for graphing"
"0","    c(""Math Self-Efficacy"", ""Math Enjoyment"", ""Math Effort"", ""Math Answers Make Sense""),"
"0","    names_to = ""facet"","
"0","    values_to = ""y"""
"0","  )"
"0",""
"0","#Plot graph"
"0","ggplot(surveyFenton) +"
"0","  geom_col(aes(x=treatment, y=y, fill=treatment))+"
"0","  geom_text(aes(x=treatment, y=y, label=y),"
"0","            position = position_stack(vjust = 1.2))+"
"0","  facet_wrap(vars(facet)) #Face wrapping is closest possible to original format"
"0",""
